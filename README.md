# ğŸ“ˆ Tushare æ•°æ®é¢æ¿ç³»ç»Ÿ

**æ•°æ®æ•´åˆå·¥ä½œå° + è‚¡ç¥¨åˆ†æç»ˆç«¯**  
æ¨¡ä»¿ Tableau Prep / Alteryxï¼ˆæ•°æ®æ•´åˆï¼‰ä¸ TradingView / åŒèŠ±é¡ºï¼ˆè‚¡ç¥¨ç»ˆç«¯ï¼‰çš„æœ¬åœ°æ•°æ®é¢æ¿ç³»ç»Ÿ

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ  Market Terminalï¼ˆè‚¡ç¥¨åˆ†æç»ˆç«¯ï¼‰
- âœ… è‡ªé€‰è‚¡åˆ—è¡¨ç®¡ç†
- âœ… Kçº¿å›¾ä¸æŠ€æœ¯æŒ‡æ ‡ï¼ˆMA5/MA20ï¼‰
- âœ… æ¯æ—¥æŒ‡æ ‡ï¼ˆPE/PB/å¸‚å€¼/æ¢æ‰‹ç‡ï¼‰
- âœ… ä¼°å€¼å¡ç‰‡ä¸èµ°åŠ¿
- ğŸ”² ç­›é€‰å™¨ï¼ˆåç»­ç‰ˆæœ¬ï¼‰
- ğŸ”² å¤šå›¾å¸ƒå±€ï¼ˆè·¯çº¿Bï¼‰

### ğŸ”§ Data Studioï¼ˆæ•°æ®æ•´åˆå·¥ä½œå°ï¼‰
- âœ… æŒ‰äº¤æ˜“æ—¥æ‹‰å–å…¨å¸‚åœºè¡Œæƒ…
- âœ… æ‰¹é‡æ‹‰å–æ—¥æœŸèŒƒå›´
- âœ… é¢æ¿æ„å»ºï¼ˆdaily_panel / funda_panelï¼‰
- âœ… å¢é‡æ°´ä½ç®¡ç†ï¼ˆæ–­ç‚¹ç»­è·‘ï¼‰
- ğŸ”² å¯è§†åŒ–æ‹–æ‹½Canvasï¼ˆè·¯çº¿Bï¼‰

### ğŸ“Š API Catalogï¼ˆæ¥å£ç›®å½•ï¼‰
- âœ… 40+æ¥å£æ³¨å†Œè¡¨ï¼ˆ5000+ç§¯åˆ†å¯ç”¨èŒƒå›´ï¼‰
- âœ… æƒé™é€æ˜ï¼ˆç§¯åˆ†é—¨æ§› / ç‹¬ç«‹æƒé™ï¼‰
- âœ… ä¸»é”® / å¢é‡å­—æ®µå®šä¹‰
- âœ… æ¥å£èƒ½åŠ›æ¢æµ‹

### âš™ï¸ Settingsï¼ˆç³»ç»Ÿè®¾ç½®ï¼‰
- âœ… Tokené…ç½®ä¸æµ‹è¯•
- âœ… ç§¯åˆ†æŸ¥è¯¢ä¸åˆ°æœŸæ—¥æœŸ
- âœ… æ•°æ®åº“ç»Ÿè®¡

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2ï¸âƒ£ é…ç½®Token

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ Tushare Token
# TUSHARE_TOKEN=your_token_here
# TUSHARE_POINTS=5000
```

### 3ï¸âƒ£ åˆå§‹åŒ–æ•°æ®åº“

```bash
python scripts/init_db.py
```

### 4ï¸âƒ£ å¯åŠ¨UI

```bash
streamlit run ui/app.py
```

æµè§ˆå™¨å°†è‡ªåŠ¨æ‰“å¼€ `http://localhost:8501`

---

## ğŸ“‹ ä½¿ç”¨æµç¨‹

### é¦–æ¬¡ä½¿ç”¨ï¼ˆå†·å¯åŠ¨ï¼‰

1. **é…ç½®Token**ï¼šè¿›å…¥ Settings é¡µé¢ï¼Œè¾“å…¥Tokenå¹¶æµ‹è¯•è¿æ¥
2. **æ‹‰å–åŸºç¡€æ•°æ®**ï¼š
   - è¿›å…¥ Data Studio â†’ æ‹‰å–äº¤æ˜“æ—¥å†ï¼ˆ2010-è‡³ä»Šï¼‰
   - æ‹‰å–è‚¡ç¥¨åˆ—è¡¨
3. **æ‹‰å–è¡Œæƒ…æ•°æ®**ï¼š
   - é€‰æ‹©æ—¥æœŸèŒƒå›´ï¼Œæ‰¹é‡æ‹‰å–æ—¥çº¿è¡Œæƒ…
   - å»ºè®®å…ˆæ‹‰å–æœ€è¿‘30-90å¤©
4. **æ„å»ºé¢æ¿**ï¼š
   - å¯¹æ‹‰å–çš„æ—¥æœŸèŒƒå›´æ‰§è¡Œ"æ‰¹é‡æ„å»ºé¢æ¿"
   - ç”Ÿæˆ daily_panelï¼ˆä¾›ç»ˆç«¯æŸ¥è¯¢ï¼‰
5. **å¼€å§‹åˆ†æ**ï¼šè¿›å…¥ Market Terminal æŸ¥çœ‹è¡Œæƒ…

### æ—¥å¸¸å¢é‡æ›´æ–°

```bash
# æ¯æ—¥å®šæ—¶ä»»åŠ¡ï¼ˆæ¨èï¼‰
# 1. æ‹‰å–æ˜¨æ—¥/ä»Šæ—¥è¡Œæƒ…
# 2. æ„å»ºæ˜¨æ—¥/ä»Šæ—¥é¢æ¿
# 3. æŸ¥çœ‹ç»ˆç«¯æ•°æ®
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•°æ®åˆ†å±‚
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tushare Pro API (æ•°æ®æº)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
          â”‚  Rawå±‚   â”‚  åŸå§‹æ¥å£æ•°æ®ï¼ˆå¯è¿½æº¯ï¼‰
          â”‚  (DuckDB)â”‚  raw_daily / raw_daily_basic / raw_adj_factor
          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚
          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
          â”‚ Cleanå±‚  â”‚  æ¸…æ´—è§„èŒƒåŒ–ï¼ˆå­—æ®µç»Ÿä¸€ã€å»é‡ï¼‰
          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚
          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
          â”‚ Serveå±‚  â”‚  é¢æ¿æ•°æ®ï¼ˆdaily_panel / funda_panelï¼‰
          â”‚ (DuckDB) â”‚  æ ¸å¿ƒæŸ¥è¯¢è¡¨ï¼Œå¸¦ä¸»é”®ä¸ç´¢å¼•
          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚
          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
          â”‚    UI    â”‚  Streamlitå‰ç«¯ï¼ˆMarket Terminal / Data Studioï¼‰
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **ç»å¯¹ç´¢å¼•**ï¼š`(ts_code, trade_date)` å”¯ä¸€ä¸»é”®ï¼Œç¦æ­¢ç›¸å¯¹ç´¢å¼•
2. **æƒé™é€æ˜**ï¼šæ‰€æœ‰æ¥å£æ˜¾ç¤ºç§¯åˆ†é—¨æ§›ä¸å½“å‰çŠ¶æ€
3. **å¢é‡å¯æ¢å¤**ï¼šæŒ‰æ—¥æœŸæ°´ä½å¢é‡ï¼Œæ”¯æŒæ–­ç‚¹ç»­è·‘
4. **é™é¢‘ä¿æŠ¤**ï¼š500æ¬¡/åˆ†é’Ÿï¼ˆ5000+ç§¯åˆ†æ¡£ä½ï¼‰

---

## ğŸ“‚ ç›®å½•ç»“æ„

```
Tushare/
â”œâ”€â”€ config/                  # é…ç½®
â”‚   â”œâ”€â”€ settings.py         # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ endpoint_registry.yaml  # æ¥å£æ³¨å†Œè¡¨ï¼ˆ40+æ¥å£ï¼‰
â”œâ”€â”€ data/                    # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ clean/              # æ¸…æ´—æ•°æ®
â”‚   â””â”€â”€ serve/              # æœåŠ¡å±‚ï¼ˆDuckDBï¼‰
â”œâ”€â”€ src/                     # æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ database.py     # DuckDBç®¡ç†
â”‚   â”‚   â”œâ”€â”€ tushare_client.py  # Tushareå®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ rate_limiter.py    # é™é¢‘å™¨
â”‚   â”œâ”€â”€ etl/                # ETLæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ extractors.py   # æ•°æ®æå–
â”‚   â”‚   â”œâ”€â”€ transformers.py # æ•°æ®è½¬æ¢
â”‚   â”‚   â””â”€â”€ loaders.py      # æ•°æ®åŠ è½½
â”‚   â”œâ”€â”€ panel/              # é¢æ¿æ„å»º
â”‚   â”‚   â”œâ”€â”€ daily_panel.py  # äº¤æ˜“æ—¥é¢æ¿
â”‚   â”‚   â””â”€â”€ funda_panel.py  # è´¢åŠ¡é¢æ¿
â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ ui/                      # Streamlit UI
â”‚   â”œâ”€â”€ app.py              # ä¸»åº”ç”¨
â”‚   â””â”€â”€ pages/              # å¤šé¡µé¢
â”‚       â”œâ”€â”€ 1_ğŸ _Market_Terminal.py
â”‚       â”œâ”€â”€ 2_ğŸ”§_Data_Studio.py
â”‚       â”œâ”€â”€ 3_ğŸ“Š_API_Catalog.py
â”‚       â””â”€â”€ 4_âš™ï¸_Settings.py
â”œâ”€â”€ scripts/                 # è„šæœ¬
â”‚   â”œâ”€â”€ init_db.py          # åˆå§‹åŒ–æ•°æ®åº“
â”‚   â””â”€â”€ probe_capabilities.py  # æ¢æµ‹æ¥å£èƒ½åŠ›
â”œâ”€â”€ requirements.txt         # ä¾èµ–
â”œâ”€â”€ .env.example            # é…ç½®æ¨¡æ¿
â””â”€â”€ README.md               # æœ¬æ–‡ä»¶
```

---

## ğŸ“Š æ¥å£æ³¨å†Œè¡¨ï¼ˆ5000+ç§¯åˆ†å¯ç”¨ï¼‰

### æ ¸å¿ƒæ¥å£
| æ¥å£å | ç±»åˆ« | æœ€ä½ç§¯åˆ† | ä¸»é”® | å¢é‡å­—æ®µ |
|--------|------|---------|------|---------|
| daily | è‚¡ç¥¨è¡Œæƒ… | 120 | (ts_code, trade_date) | trade_date |
| daily_basic | è‚¡ç¥¨è¡Œæƒ… | 2000 | (ts_code, trade_date) | trade_date |
| adj_factor | è‚¡ç¥¨è¡Œæƒ… | 2000 | (ts_code, trade_date) | trade_date |
| income | è´¢åŠ¡æ•°æ® | 2000 | (ts_code, end_date, ann_date) | ann_date |
| balancesheet | è´¢åŠ¡æ•°æ® | 2000 | (ts_code, end_date, ann_date) | ann_date |
| cashflow | è´¢åŠ¡æ•°æ® | 2000 | (ts_code, end_date, ann_date) | ann_date |
| fina_indicator | è´¢åŠ¡æ•°æ® | 2000 | (ts_code, end_date, ann_date) | ann_date |
| trade_cal | åŸºç¡€æ•°æ® | 2000 | (exchange, cal_date) | cal_date |
| stock_basic | åŸºç¡€æ•°æ® | 2000 | (ts_code) | list_date |

å®Œæ•´40+æ¥å£è¯·æŸ¥çœ‹ [config/endpoint_registry.yaml](config/endpoint_registry.yaml)

---

## ğŸ”§ ä¸¤æ¡å®ç°è·¯çº¿

### è·¯çº¿Aï¼šå¿«é€ŸåŸå‹ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰
- âœ… Streamlit + Plotly
- âœ… æ­¥éª¤å¼æµç¨‹ï¼ˆæ‰‹åŠ¨è¿è¡Œï¼‰
- âœ… DuckDBæœ¬åœ°å­˜å‚¨
- â±ï¸ å¼€å‘å‘¨æœŸï¼š1-2å‘¨

### è·¯çº¿Bï¼šä¸“ä¸šç‰ˆï¼ˆå‡çº§è®¡åˆ’ï¼‰
- ğŸ”² React + FastAPI
- ğŸ”² å¯è§†åŒ–æ‹–æ‹½Canvasï¼ˆReact Flowï¼‰
- ğŸ”² å¤šå›¾å¸ƒå±€ä¸è”åŠ¨
- ğŸ”² Electronæ¡Œé¢åº”ç”¨
- â±ï¸ å¼€å‘å‘¨æœŸï¼š4-8å‘¨

**å‡çº§æ—¶æœº**ï¼šè·¯çº¿AéªŒè¯å®Œæˆï¼Œä¸šåŠ¡é€»è¾‘ç¨³å®šå

---

## ğŸ§ª æµ‹è¯•ä¸æ¢æµ‹

### æ¢æµ‹æ¥å£èƒ½åŠ›
```bash
python scripts/probe_capabilities.py
```

å°†æ¢æµ‹æ‰€æœ‰æ¥å£çš„å®é™…å¯ç”¨æ€§ï¼Œå¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚

### æŸ¥è¯¢é¢æ¿æ•°æ®
```python
from src.panel import DailyPanelBuilder

builder = DailyPanelBuilder()
df = builder.query_panel(
    ts_codes=["000001.SZ"],
    start_date="2024-01-01",
    end_date="2024-12-31"
)
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: Tokenåœ¨å“ªé‡Œè·å–ï¼Ÿ
è®¿é—® [Tushareå®˜ç½‘](https://tushare.pro) æ³¨å†Œè´¦å·ï¼Œå®Œæˆç§¯åˆ†ä»»åŠ¡ååœ¨ä¸ªäººä¸­å¿ƒè·å–ã€‚

### Q2: æ²¡æœ‰5000ç§¯åˆ†æ€ä¹ˆåŠï¼Ÿ
- 120ç§¯åˆ†ï¼šå¯ç”¨æ—¥çº¿è¡Œæƒ…ï¼ˆdailyï¼‰ï¼Œä½†é¢‘æ¬¡å—é™
- 2000ç§¯åˆ†ï¼šå¯ç”¨å¤§éƒ¨åˆ†æ¥å£ï¼ˆ200æ¬¡/åˆ†é’Ÿï¼‰
- ä¿®æ”¹ `.env` ä¸­çš„ `TUSHARE_POINTS` é…ç½®

### Q3: æ•°æ®æ‹‰å–å¾ˆæ…¢ï¼Ÿ
- æŒ‰äº¤æ˜“æ—¥æ‹‰å–ï¼ˆæ¨èï¼‰ï¼šä¸€å¤©5000è‚¡ç¥¨ä¸€æ¬¡æ‹‰å®Œ
- é¿å…æŒ‰è‚¡ç¥¨ä»£ç å¾ªç¯æ‹‰å–
- 5000+ç§¯åˆ†é™é¢‘ï¼š500æ¬¡/åˆ†é’Ÿ

### Q4: æŠ¥é”™ "æƒé™ä¸è¶³"ï¼Ÿ
- æ£€æŸ¥ API Catalog æŸ¥çœ‹æ¥å£çš„æœ€ä½ç§¯åˆ†è¦æ±‚
- éƒ¨åˆ†æ¥å£éœ€è¦ç‹¬ç«‹å¼€é€šï¼ˆåˆ†é’Ÿçº¿ã€æ–°é—»å…¬å‘Šç­‰ï¼‰

### Q5: å¦‚ä½•å‡çº§åˆ°è·¯çº¿Bï¼Ÿ
- å½“å‰ä¿æŒæ•°æ®å±‚ä¸å˜ï¼ˆdatabase.pyã€é¢æ¿æ„å»ºé€»è¾‘ï¼‰
- å‰ç«¯æ›¿æ¢ä¸º React + FastAPI
- å‚è€ƒç³»ç»Ÿæ¶æ„æ–‡æ¡£

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue ä¸ PRï¼

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

## ğŸ™ è‡´è°¢

- [Tushare Pro](https://tushare.pro) - æ•°æ®æº
- [Streamlit](https://streamlit.io) - UIæ¡†æ¶
- [DuckDB](https://duckdb.org) - æ•°æ®åº“

---

**ğŸ’¡ æç¤º**ï¼šæœ¬ç³»ç»Ÿä¸ºè·¯çº¿Aå¿«é€ŸåŸå‹ï¼Œæ ¸å¿ƒé€»è¾‘å·²éªŒè¯ã€‚åç»­å¯æ— ç¼å‡çº§ä¸ºè·¯çº¿Bä¸“ä¸šç‰ˆã€‚